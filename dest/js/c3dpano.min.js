"use strict";function Ceramic3DPanorama(e){function i(e,r){s=e,c=r,m.width=e,m.height=r,h.viewport(0,0,e,r),U=!0}function f(){(requestAnimationFrame(f),m.scrollWidth==s&&m.scrollHeight==c||(i(m.scrollWidth,m.scrollHeight),M=I-1),!X||0==N&&0==D)||(b<(C+=N*F)?C-=b:C<=0&&(C+=b),x<(S+=(e=D)*F)?S=x:S<-x&&(S=-x),D=N=0,U=!0);if(M!=I){M=I,U=!0;var e,r=s/c,t=-(r=(e=.05*Math.tan((Math.PI/3-I/10)/2))*r),a=-e,o=1/(r-t),n=1/(e-a);B[0]=.1*o,B[1]=0,B[2]=0,B[3]=0,B[4]=0,B[5]=.1*n,B[6]=0,B[7]=0,B[8]=(t+r)*o,B[9]=(a+e)*n,B[10]=1/-9.95*10.05,B[11]=-1,B[12]=0,B[13]=0,B[14]=1/-9.95*1,B[15]=0}U&&(U=!1,e=Math.cos(C),r=Math.sin(C),t=Math.cos(S),a=Math.sin(S),L[0]=e,L[1]=r*a,L[2]=-r*t,L[3]=0,L[4]=t,L[5]=a,L[6]=r,L[7]=-e*a,L[8]=e*t,h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),h.useProgram(T),h.bindBuffer(h.ARRAY_BUFFER,d),h.vertexAttribPointer(g,3,h.FLOAT,!1,0,0),h.uniformMatrix3fv(_,!1,L),h.uniformMatrix4fv(A,!1,B),h.uniform1f(v,P),h.activeTexture(h.TEXTURE0),h.bindTexture(h.TEXTURE_CUBE_MAP,u),h.uniform1i(R,0),h.drawArrays(h.TRIANGLES,0,36))}function r(e,r){var t=h.createShader(h.VERTEX_SHADER);if(h.shaderSource(t,e),h.compileShader(t),h.getShaderParameter(t,h.COMPILE_STATUS)){var a=h.createShader(h.FRAGMENT_SHADER);if(h.shaderSource(a,r),h.compileShader(a),h.getShaderParameter(a,h.COMPILE_STATUS)){var o=h.createProgram();if(h.attachShader(o,t),h.attachShader(o,a),h.linkProgram(o),h.getProgramParameter(o,h.LINK_STATUS))return o;console.error(h.getProgramInfoLog(o))}else console.error(h.getShaderInfoLog(a))}else console.error(h.getShaderInfoLog(t))}var t,a,o,n,s,c,E=0,l=!1,m=e.canvas;"string"==typeof m&&(m=document.getElementById(m));var u,T,_,A,R,v,g,d,h=m.getContext("webgl")||m.getContext("experimental-webgl"),U=!0,P=1==e.cameraVersion?1:-1;if(!p)var p="undefined"!=typeof Float32Array?Float32Array:Array;var M=-100,I=0,B=new p(16),L=new p(9),F=Math.PI/200,b=2*Math.PI,x=Math.PI/2,C=0,S=0,w=0,y=0,X=!1,N=0,D=0;h.clearColor(1,1,1,1),n=r("attribute vec3 a; varying vec2 v; void main() {v = a.xy; gl_Position = vec4(a, 1.0);}","precision mediump float; uniform float perc; varying vec2 v; void main() {if (abs(v.x) > 0.4 || abs(v.y) > 0.05) discard;if ((v.x + 0.4)/0.8 < perc) gl_FragColor = vec4(0.0, 0.7, 0.0, 1.0); else gl_FragColor = vec4(0.7, 0.7, 0.7, 1.0);}"),t=h.getUniformLocation(n,"perc"),a=h.getAttribLocation(n,"a"),h.enableVertexAttribArray(a),o=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,o),h.bufferData(h.ARRAY_BUFFER,new p([-1,-1,0,-1,1,0,1,-1,0,1,1,0,-1,1,0,1,-1,0]),h.STATIC_DRAW),function e(){l||(requestAnimationFrame(e),(m.scrollWidth!=s||m.scrollHeight!=c)&&i(m.scrollWidth,m.scrollHeight),U&&(U=!1,h.clear(h.COLOR_BUFFER_BIT|h.DEPTH_BUFFER_BIT),h.useProgram(n),h.bindBuffer(h.ARRAY_BUFFER,o),h.vertexAttribPointer(a,3,h.FLOAT,!1,0,0),h.uniform1f(t,E),h.drawArrays(h.TRIANGLES,0,6)))}();var O=e.panorams[0],Y=(e=function(){T=r("uniform mat3 vm; uniform mat4 pm; attribute vec3 a; varying vec3 v; void main() {v = a; gl_Position = pm * vec4(vm * a, 1.0);}","precision mediump float; uniform samplerCube t; uniform float Ysign; varying vec3 v; void main() {gl_FragColor = textureCube(t, vec3(v.x, Ysign * v.z, -v.y));}"),_=h.getUniformLocation(T,"vm"),A=h.getUniformLocation(T,"pm"),R=h.getUniformLocation(T,"t"),v=h.getUniformLocation(T,"Ysign"),g=h.getAttribLocation(T,"a"),h.enableVertexAttribArray(g),d=h.createBuffer(),h.bindBuffer(h.ARRAY_BUFFER,d),h.bufferData(h.ARRAY_BUFFER,function(){for(var e=new p(108),r=new p(3),t=new p(3),a=0,o=0;o<3;o++){r[0]=o,r[1]=(o+1)%3,r[2]=(o+2)%3;for(var n=-1;n<2;n+=2)for(var i=0,f=-1;f<2;f+=2)for(var s=-1;s<2;s+=2){t[r[0]]=n,t[r[1]]=f,t[r[2]]=s;for(var c=0;c<3;c++)e[3*a+c]=t[c];if(1==i||2==i)for(c=0;c<3;c++)e[3*(a+2)+c]=t[c];2==i&&(a+=2),a++,i++}}return e}(),h.STATIC_DRAW)},function(){if(0==--q){var e=j;m.onmousemove=function(e){var r=e.pageX-m.offsetLeft;e=e.pageY-m.offsetTop;N=r-w,D=e-y,w=r,y=e},m.onmouseout=function(){X=!1},m.onmousedown=function(e){1==e.which&&(X=!0)},m.onmouseup=function(e){1==e.which&&(X=!1)},m.onwheel=function(e){0<e.wheelDelta?I=Math.min(I+1,6):e.wheelDelta<0&&(I=Math.max(I-1,-10)),e.deltaY<0?I=Math.min(I+1,6):0<e.deltaY&&(I=Math.max(I-1,-10))};var r=h.createTexture();h.bindTexture(h.TEXTURE_CUBE_MAP,r),h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!0);for(var t=0;t<6;t++)h.texImage2D(h.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,e[t]);h.generateMipmap(h.TEXTURE_CUBE_MAP),h.getError()==h.NO_ERROR?h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR_MIPMAP_LINEAR):h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_CUBE_MAP,h.TEXTURE_MAG_FILTER,h.LINEAR),h.bindTexture(h.TEXTURE_CUBE_MAP,null),u=r,U=!(l=!0),f()}}),G=function(r){return function(e){isNaN(k[r])&&0<e.total&&(k[r]=e.total,K[r]=0,$+=e.total,J--),!isNaN(k[r])&&e.loaded>K[r]&&(z+=e.loaded-K[r],K[r]=e.loaded,0==J&&(E=z/$,U=!0))}},H=function(r,t){return function(){if(isNaN(k[r])?J--:k[r]>K[r]&&(z+=k[r]-K[r],K[r]=k[r],0==J&&(E=z/$,U=!0)),200<=this.status&&this.status<400)if(t){var e=this.getAllResponseHeaders().match(/^Content-Type\:\s*(.*?)$/im)[1]||"image/png";e=new Blob([this.response],{type:e});j[r]=new Image,j[r].onload=Y,j[r].src=window.URL.createObjectURL(e)}else j[r]=this.response,Y();else console.error("Unable to load file "+O[r]+"!"),Y()}},W=void 0!==(new window.XMLHttpRequest).onprogress,V=O.length,q=V;e&&q++;var j=Array(V),K=Array(V),k=Array(V),z=0,$=0,J=V;if(!W){for(var Q=0;Q<V;Q++)K[Q]=0,k[Q]=1;$=V,J=0}for(Q=0;Q<V;Q++){var Z=O[Q],ee=".jpg"==(re=Z.substr(Z.lastIndexOf(".")))||".bmp"==re||".png"==re,re=ee||".bin"==re;if(!W&&ee)j[Q]=new Image,j[Q].onload=function(){E=++z/$,U=!0,Y()},j[Q].src=Z;else{var te=new XMLHttpRequest;te.onload=H(Q,ee),W&&(te.onprogress=G(Q)),te.open("GET",Z,!0),re&&(te.responseType="arraybuffer"),te.send()}}e&&(e(),Y())}
//# sourceMappingURL=maps/c3dpano.min.js.map
